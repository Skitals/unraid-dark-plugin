Menu="UserPreferences"
Title="Dark Theme"
Icon="file"
---

<?


$theme = exec("cat /boot/config/plugins/dynamix/dynamix.cfg | grep 'theme=\"dark\"'");
$output = $theme;


?>

<font size='3'>
<?

	if ($output)
		echo "<font color='green'>Dark Theme currently enabled</font>";
	else {
		echo "<font color='orange'>Dark Theme currently disabled</font>";
		
}
?>
</font>
<br><br>
<iframe src="/plugins/dark.theme/scripts/image.php?grayscale=65" height="400" width="500" style="border:none" id="imagesample"></iframe>
<div id="slidecontainer">
<p><input type="range" min="0" max="100" value="65" class="slider-color" id="id1"></p>
<span>Value:</span> <span id="f" style="font-weight:bold;color:red"></span>
<input type='button' onclick='refreshImage();' value='Preview'>
<input type='button' onclick='applyGrayscale();' value='Apply Changes'>
<span id="changes" style="font-weight:bold;color:red"></span>
</div>
<br><br>
<?if ($output):?>
<input type='button' onclick='$(this).hide();disableDark();' value='Disable Dark'>
<?else:?>
<input type='button' onclick='$(this).hide();enableDark();' value='Enable Dark'>
<?endif;?>
<script>
$(function() {
	if ( typeof caPluginUpdateCheck === "function" ) {
		caPluginUpdateCheck("dark.theme.plg",{name:"Skital's Dark Theme"});
	}
});

function enableDark() {
	$.post("/plugins/dark.theme/scripts/enableDark.php",{},function(data) {
		if (data) {
			location.reload();
		}
	});
}
function disableDark() {
	$.post("/plugins/dark.theme/scripts/disableDark.php",{},function(data) {
		if (data) {
			location.reload();
		}
	});
}

var slideCol = document.getElementById("id1");
var y = document.getElementById("f");
y.innerHTML = slideCol.value;

slideCol.oninput = function() {
    y.innerHTML = this.value;
}

function refreshImage() {
        document.getElementById('imagesample').src = "/plugins/dark.theme/scripts/image.php?grayscale=" + y.innerHTML;
}

function applyGrayscale() {
            $.ajax({
                type: "GET",
                url: "/plugins/dark.theme/scripts/applyGrayscale.php" ,
                data: { grayscale: y.innerHTML },
                success : function() {
                    document.getElementById("changes").innerHTML = "changes saved (" + y.innerHTML + ")";

                }
            });
        }
</script>
